// ========== ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà - ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á) ==========
let bgMusic = null;
let isMusicPlaying = false;

function initMusic() {
    // ‡πÉ‡∏ä‡πâ audio element ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô HTML
    bgMusic = document.getElementById('bgMusic');
    
    if (!bgMusic) {
        console.error('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö audio element');
        return;
    }
    
    bgMusic.volume = 0.3; // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á (0.0 - 1.0)
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏û‡∏•‡∏á
    const musicControl = document.createElement('div');
    musicControl.className = 'music-control';
    musicControl.innerHTML = `
        <button class="music-btn" id="musicBtn" title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á">
            üéµ
        </button>
    `;
    document.body.appendChild(musicControl);
    
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°
    const musicBtn = document.getElementById('musicBtn');
    musicBtn.addEventListener('click', toggleMusic);
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (!bgMusic.paused) {
        musicBtn.textContent = 'üé∂';
        musicBtn.classList.add('playing');
        isMusicPlaying = true;
    }
    
    // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    tryAutoplay();
}

function toggleMusic() {
    const musicBtn = document.getElementById('musicBtn');
    
    if (isMusicPlaying) {
        bgMusic.pause();
        musicBtn.textContent = 'üéµ';
        musicBtn.classList.remove('playing');
        isMusicPlaying = false;
        console.log('‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á');
    } else {
        bgMusic.play().then(() => {
            musicBtn.textContent = 'üé∂';
            musicBtn.classList.add('playing');
            isMusicPlaying = true;
            console.log('‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á');
        }).catch(err => {
            console.log('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡πÑ‡∏î‡πâ:', err);
        });
    }
}

function tryAutoplay() {
    // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    bgMusic.play().then(() => {
        const musicBtn = document.getElementById('musicBtn');
        musicBtn.textContent = 'üé∂';
        musicBtn.classList.add('playing');
        isMusicPlaying = true;
        console.log('‚úÖ ‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }).catch(err => {
        console.log('‚ö†Ô∏è ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å autoplay - ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á');
        
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ
        const playOnInteraction = function() {
            if (!isMusicPlaying && bgMusic.paused) {
                const musicBtn = document.getElementById('musicBtn');
                bgMusic.play().then(() => {
                    musicBtn.textContent = 'üé∂';
                    musicBtn.classList.add('playing');
                    isMusicPlaying = true;
                    console.log('‚úÖ ‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ interaction');
                }).catch(e => {
                    console.log('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡πÑ‡∏î‡πâ:', e);
                });
            }
            // ‡∏•‡∏ö event listeners ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß
            document.removeEventListener('click', playOnInteraction);
            document.removeEventListener('touchstart', playOnInteraction);
            document.removeEventListener('keydown', playOnInteraction);
        };
        
        // ‡∏ü‡∏±‡∏á‡∏´‡∏•‡∏≤‡∏¢ events ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ
        document.addEventListener('click', playOnInteraction, { once: true });
        document.addEventListener('touchstart', playOnInteraction, { once: true });
        document.addEventListener('keydown', playOnInteraction, { once: true });
    });
}

// ========== Smooth Scroll & Animation ==========
document.addEventListener('DOMContentLoaded', function() {
    console.log('üéâ Happy New Year 2026!');
    
    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏•‡∏á
    initMusic();
});

// ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ==========
function trackProgress() {
    const currentPage = window.location.pathname;
    
    if (currentPage.includes('q')) {
        const pageNumber = currentPage.match(/q(\d+)/)?.[1];
        console.log(`üìñ ‡∏≠‡πà‡∏≤‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà ${pageNumber} ‡πÅ‡∏•‡πâ‡∏ß`);
    }
}

trackProgress();

// ========== Keyboard Navigation ==========
// ‡∏Å‡∏î Arrow Left/Right ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤/‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowLeft') {
        const prevButton = document.querySelector('.btn-prev');
        if (prevButton) prevButton.click();
    } else if (e.key === 'ArrowRight') {
        const nextButton = document.querySelector('.btn-next');
        if (nextButton) nextButton.click();
    }
});